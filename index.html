<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configuración de Páginas Web</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>
    <h1>Gestión de Configuración de Webs</h1>

    <section id="add-web-config">
        <h2>Configurar una Página Web</h2>
        <form id="web-config-form">
            <label for="url">URL:</label>
            <input type="text" id="url" name="url" placeholder="Ej.: https://example.com/tips" required><br><br>
            
            <label for="title_keywords">Títulos (separados por coma):</label>
            <input type="text" id="title_keywords" name="title_keywords" placeholder="Ej.: pronóstico, tip, apuesta" required><br><br>

            <label for="date_patterns">Formatos de Fecha (separados por coma):</label>
            <input type="text" id="date_patterns" name="date_patterns" placeholder="Ej.: DD/MM/YYYY, dd.mm.aa, YYYY-MM-DD, MM-DD-YYYY" required><br><br>

            <label for="tip_patterns">Palabras Clave (separadas por coma):</label>
            <input type="text" id="tip_patterns" name="tip_patterns" placeholder="Ej.: pick, cuota, predicción" required><br><br>

            <label for="tips_container">Selector CSS para Pronósticos:</label>
            <input type="text" id="tips_container" name="tips_container" placeholder="Ej.: .tips-container > div.tip" required><br><br>

            <label for="date_location">Selector CSS para Fecha:</label>
            <input type="text" id="date_location" name="date_location" placeholder="Ej.: .date-header" required><br><br>

            <label for="title_location">Selector CSS para Títulos:</label>
            <input type="text" id="title_location" name="title_location" placeholder="Ej.: .title h1" required><br><br>

            <button type="submit">Guardar Configuración</button>
            <!-- Botón para escanear las webs -->
<button id="scanButton">Escanear Webs</button>

        </form>
    </section>

    <script>
        document.getElementById('web-config-form').addEventListener('submit', async function(event) {
            event.preventDefault();

            const url = document.getElementById('url').value;
            const title_keywords = document.getElementById('title_keywords').value.split(',').map(s => s.trim());
            const date_patterns = document.getElementById('date_patterns').value.split(',').map(s => s.trim());
            const tip_patterns = document.getElementById('tip_patterns').value.split(',').map(s => s.trim());
            const tips_container = document.getElementById('tips_container').value;
            const date_location = document.getElementById('date_location').value;
            const title_location = document.getElementById('title_location').value;

            try {
                const response = await axios.post('http://localhost:3001/api/add-web-config', {
                    url,
                    title_keywords,
                    date_patterns,
                    tip_patterns,
                    html_structure: {
                        tips_container,
                        date_location,
                        title_location
                    }
                });

                alert(response.data.message);
            } catch (error) {
                console.error('Error al guardar configuración:', error);
                alert('Error al guardar la configuración.');
            }
        });
    </script>
</body>
</html>
